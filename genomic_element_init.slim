defineConstant("L", initializeAncestralNucleotides(ref_path));
initializeRecombinationRate(0);

defineGlobal("effsize_pos", readCSV(paste0(cwdir, "/causal_gene_info.csv"), colNames = T));
initializeMutationTypeNuc(0, 1, "f", 0.0); // Neutral mutations
initializeGenomicElementType(0, 0, 1.0, mmJukesCantor(mut_rate)); // 1/12 yearly mutation rate
	
initializeGenomicElement(0, 0, effsize_pos.subset(0,1) - 1);
for (i in 1:n_causal_genes)
{
	initializeMutationTypeNuc(i, 1, "f", effsize_pos.subset(i-1,3));
	initializeGenomicElementType(i, i, 1.0, mmJukesCantor(mut_rate));
	initializeGenomicElement(i, effsize_pos.subset(i-1,1), effsize_pos.subset(i-1,2) - 1);
	if (i==n_causal_genes)
	{
		initializeGenomicElement(0, effsize_pos.subset(i-1,2), L-1);
	}
	else
	{
		initializeGenomicElement(0, effsize_pos.subset(i-1,2), effsize_pos.subset(i,1) - 1);
	}
}